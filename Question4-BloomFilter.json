{"paragraphs":[{"text":"def broadcast_filter(bloom_filter_small_df: org.apache.spark.util.sketch.BloomFilter) = udf((modelType: String) => \r\n  if(modelType != null) bloom_filter_small_df.mightContain(modelType) else false)\r\n  \r\nval big_df = spark.read.format(\"csv\").option(\"header\", \"true\").load(\"C:/Users/varun/Documents/spark-projects/midterm_spark_projects/drive_stats_2019_Q1/*.csv\")\r\nval small_df = spark.read.format(\"csv\").option(\"header\", \"true\").load(\"C:/Users/varun/Documents/spark-projects/midterm_spark_projects/drive_stats_2019_Q1/2019-03-31.csv\")\r\n\r\nval bloom_f = small_df.stat.bloomFilter($\"model\", 1000, 0.0005)\r\n\r\nval broadcast_bloom_filter = sc.broadcast(bloom_f)\r\nval result_df = big_df.select(\"date\",\"serial_number\",\"model\").where(broadcast_filter(broadcast_bloom_filter.value)($\"model\"))\r\n\r\nprintln(big_df.count())\r\nprintln(result_df.count())","user":"anonymous","dateUpdated":"2019-11-27T16:00:50-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"9577046\r\n9576387\r\nbroadcast_filter: (bloom_filter_small_df: org.apache.spark.util.sketch.BloomFilter)org.apache.spark.sql.expressions.UserDefinedFunction\r\nbig_df: org.apache.spark.sql.DataFrame = [date: string, serial_number: string ... 127 more fields]\r\nsmall_df: org.apache.spark.sql.DataFrame = [date: string, serial_number: string ... 127 more fields]\r\nbloom_f: org.apache.spark.util.sketch.BloomFilter = org.apache.spark.util.sketch.BloomFilterImpl@b16249b\r\nbroadcast_bloom_filter: org.apache.spark.broadcast.Broadcast[org.apache.spark.util.sketch.BloomFilter] = Broadcast(210)\r\nresult_df: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date: string, serial_number: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1574732249889_643323813","id":"20191125-203729_4554485","dateCreated":"2019-11-25T20:37:29-0500","dateStarted":"2019-11-26T02:47:29-0500","dateFinished":"2019-11-26T02:47:47-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:425"},{"user":"anonymous","dateUpdated":"2019-11-26T02:47:48-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574732333586_-1853176337","id":"20191125-203853_21521314","dateCreated":"2019-11-25T20:38:53-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:426"}],"name":"bloomfilter","id":"2EV8Q2D26","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}